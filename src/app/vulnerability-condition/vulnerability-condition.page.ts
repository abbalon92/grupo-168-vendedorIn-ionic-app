import { Component, OnInit } from '@angular/core';
import { Router } from '@angular/router';	
import { LoadingController } from '@ionic/angular';
import { AlertController } from '@ionic/angular';
//Servicis
import { AuthenticationService } from '../service/authentication.service';
import { SellerService } from '../service/seller.service';

@Component({
  selector: 'app-vulnerability-condition',
  templateUrl: './vulnerability-condition.page.html',
  styleUrls: ['./vulnerability-condition.page.scss'],
})
export class VulnerabilityConditionPage implements OnInit {

  title:String ="Condición de vulnerabilidad";
  vendedor:any;
  actualiza: boolean;

  listSiNo=[
    {id:"1", descripcion:"Si"},
    {id:"2", descripcion:"No"},
  ]
  nivelEscolaridad=[
    {id:"1", descripcion:"Primaria"},
    {id:"2", descripcion:"Bachillerato"},
    {id:"3", descripcion:"Tecnico"},
    {id:"4", descripcion:"Tecnólogo"},
    {id:"5", descripcion:"Profesional"},
    {id:"6", descripcion:"Ninguno"}
  ]

  constructor(private router: Router,private authenticationService:AuthenticationService,private loadingController: LoadingController,private sellerService:SellerService
    ,private alertCtrl: AlertController) { }

  ngOnInit() {
    this.vendedor=this.authenticationService.vendedor;
    }

  async guardar() {
    
    const loading = await this.loadingController.create({
      message: 'Loading'
    });
    await loading.present();
     this.sellerService.actualizaVendedor(this.vendedor)
    .subscribe(() => {
      this.actualiza=true;
      this.authenticationService.cargarVendedor();
      this.router.navigate(['/homeProfile']);
      loading.dismiss();
    }, err => {
      this.actualiza=false;
      console.log(err);
     loading.dismiss();
    });

    if(this.actualiza){
      const alert = await this.alertCtrl.create({
        message: 'Se ha actualizando correctante.',
        buttons: ['OK']
      });
       await alert.present();
      this.authenticationService.cargarVendedor();
      this.router.navigate(['/homeProfile']);
    }else{
      const alert = await this.alertCtrl.create({
        message: 'Se ha presentado un error. Comuniquese con el administrador.',
        buttons: ['OK']
      });
    }

  }


  

}
